clear, clc, close all

addpath ../
addpath ../f/
addpath ../DSP/
addpath ../../f/

DQPSK= [0 4.0688 
	2.9832 4.0944 
	5.9664 4.126 
	8.9495 4.3011 
	11.9327 4.5243 
	14.9159 4.8028 
	17.8991 5.1079 
	20.8823 5.3883 
	23.8654 5.7943 
	26.8486 6.2917 
	29.8318 6.9011 
	32.815 7.8791 
	35.7982 8.4515 
	38.7813 9.5142 
	41.7645 10.4803 
	44.7477 11.8265 
	47.7309 13.6521 
	50.7141 15.2916 
	53.6972 18.3476 
	56.6804 20.9592 
	59.6636 NaN];

QPSK = [0 2.0806 
	2.9832 1.9768 
	5.9664 2.0657 
	8.9495 2.1194 
	11.9327 2.3381 
	14.9159 2.5949 
	17.8991 2.8585 
	20.8823 3.2047 
	23.8654 3.5518 
	26.8486 3.9345 
	29.8318 4.4934 
	32.815 5.1531 
	35.7982 5.7867 
	38.7813 6.6124 
	41.7645 7.6992 
	44.7477 8.9089 
	47.7309 10.7386 
	50.7141 12.2179 
	53.6972 17.8403 
	56.6804 27.7872 
	59.6636 34.9159]; % XOR

QPSK_DSP = [0 0.89609 
	2.9832 0.94252 
	5.9664 0.90268 
	8.9495 0.94969 
	11.9327 0.90824 
	14.9159 0.92761 
	17.8991 0.98461 
	20.8823 1.0813 
	23.8654 1.0387 
	26.8486 1.0618 
	29.8318 1.0975 
	32.815 1.0652 
	35.7982 1.0882 
	38.7813 1.1606 
	41.7645 1.1614 
	44.7477 1.212 
	47.7309 1.2705 
	50.7141 1.2863 
	53.6972 1.3038 
	56.6804 1.3952 
	59.6636 1.4281];

DQPSK_DSP = [0 3.411 
	2.9832 3.3392 
	5.9664 3.3481 
	8.9495 3.3888 
	11.9327 3.3652 
	14.9159 3.3773 
	17.8991 3.4255 
	20.8823 3.4398 
	23.8654 3.4835 
	26.8486 3.4279 
	29.8318 3.4742 
	32.815 3.4799 
	35.7982 3.5678 
	38.7813 3.55 
	41.7645 3.6114 
	44.7477 3.5153 
	47.7309 3.6059 
	50.7141 3.6569 
	53.6972 3.756 
	56.6804 3.7275 
	59.6636 3.703 ];

% QPSK_DSP_BER_L=1.5km_lamb=1380nm_ModBW=30GHz_Ntaps=7taps_Feedforward-NDA_9taps_nu=200kHz_ros=125_ENOB=4
folder = 'QPSK_DSP/';

Rb = 2*112e9;
Rs = Rb/(4);
BERtarget = 1.8e-4;
ros = 5/4;
EqNtaps = 7;
ENOB = 5;
CPR = 'Feedforward-NDA';
CPRtaps = 9;
Modulator = 'SiPhotonics';
ModBW = 30;
linewidth = 200;
lamb = [1250 1380];

R = 1;
q = 1.60217662e-19;

SNRdB2PrxdBm = @(SNRdB) 10*log10(10^(SNRdB/10)*2*q*Rs/(R*1e-3));
SNRdBref = SNRreq(BERtarget, 4, 'QAM');

PrefdBm = -35.0798;


